<!----http://localhost:7456/assets/resources/native/index.html?userids=test001,test002,test003,test004&pwd=wlj123456,wlj123456,wlj123456,wlj123456-->>
<!DOCTYPE html>
<html>
<head>
    <title>Â§öÁ™óÂè£ÂÆπÂô®</title>
    <style>
        body {
            background-color: #000000;
            margin: 0;
            min-height: 100vh;
        }
        .window-container {
            display: grid;
            gap: 10px;
            padding: 20px;
            grid-template-columns: repeat(2, 1fr);
            grid-auto-rows: minmax(200px, 1fr);
            grid-auto-flow: row dense;
            height: auto;
            min-height: 100vh;
        }
        
        @media (max-width: 1200px) {
            .window-container {
                grid-template-columns: 1fr;
            }
        }
        .iframe-window {
            border: 1px solid #333;
            background: #1a1a1a;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body onload="init()">
    <div class="window-container">

    </div>
</body>
<script>

    var userIds = [];
    var pwds = [];
    function init() {
        // Ëé∑ÂèñURLÂèÇÊï∞
        const urlParams = new URLSearchParams(window.location.search);
        
        // Á§∫‰æãÔºöËé∑ÂèñÁâπÂÆöÂèÇÊï∞
        const ids = urlParams.get('userids').split(',');
        const tmppwds = urlParams.get('pwd').split(',');
        const gameId = urlParams.get('pwd');
        // ‰øÆÊ≠£ÂêéÁöÑÊó•ÂøóËæìÂá∫
        console.log('ÂàùÂßãÂåñÂèÇÊï∞:', {
            userIds: ids,
            pwds: tmppwds
        });
        userIds = ids;
        pwds = tmppwds;
        initIframes();
        // Âú®Ê≠§Ê∑ªÂä†ÂèÇÊï∞Â∫îÁî®ÈÄªËæëÔºàÂ¶ÇÔºö‰º†ÈÄíÁªôiframeÔºâ
    }
    // iframeÂä†ËΩΩÂÆåÊàêÂõûË∞É
    function onIframeLoaded(event) {
        const frame = event.target;
        
        // ÂàõÂª∫Âè≥ÈîÆËèúÂçï
        const menu = document.createElement('div');
        menu.style = `position:absolute;background:#333;color:#fff;padding:8px;display:none;`;
        
        const reloadBtn = document.createElement('div');
        reloadBtn.textContent = 'üîÑ ÈáçÂêØ';
        reloadBtn.style = 'cursor:pointer;padding:4px;';
        reloadBtn.onclick = () => {
            frame.src = frame.src; // ÈáçÊñ∞Âä†ËΩΩ
            menu.style.display = 'none';
        };
    
        // Âè≥ÈîÆ‰∫ã‰ª∂Â§ÑÁêÜ
        // ‰øÆÊîπ‰∫ã‰ª∂ÁªëÂÆöÊñπÂºè
        // ‰øÆÊ≠£‰∫ã‰ª∂ÁªëÂÆöÈÄªËæë
        frame.contentDocument.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            const iframeRect = frame.getBoundingClientRect();
            
            menu.style.left = `${e.clientX + iframeRect.left}px`;
            menu.style.top = `${e.clientY + iframeRect.top}px`;
            menu.style.display = 'block';
        });
        
        // Ê∑ªÂä†ËèúÂçïÂà∞bodyÈò≤Ê≠¢Ë¢´ÈÅÆÊå°
        document.body.appendChild(menu);
        
        // Â¢ûÂä†Èò≤ÊäñÂ§ÑÁêÜ
        let lastClick = 0;
        frame.contentDocument.addEventListener('mousedown', (e) => {
            if(Date.now() - lastClick < 300) return;
            lastClick = Date.now();
            menu.style.display = 'none';
        });
        
        // Ê∑ªÂä†ËèúÂçïÂÆπÂô®Ê†∑Âºè
        menu.style.position = 'fixed';
        menu.style.background = '#333';
        menu.style.borderRadius = '4px';
        menu.style.boxShadow = '0 2px 8px rgba(0,0,0,0.3)';
        menu.innerHTML = '';
        menu.appendChild(reloadBtn);
    
        // ÁÇπÂáªÂÖ∂‰ªñÂú∞ÊñπÈöêËóèËèúÂçï
        document.addEventListener('click', () => {
            menu.style.display = 'none';
        });
    
        frame.parentNode.appendChild(menu);
        console.log('Á™óÂè£Âä†ËΩΩÂÆåÊàê:', frame.id);
    }

    // ÂàùÂßãÂåñÊñπÊ≥ï
    function initIframes() {
        // Âà†Èô§ÂéüÊúâiframeÈùôÊÄÅ‰ª£Á†Å
        const container = document.querySelector('.window-container');
        container.innerHTML = '';

        userIds.forEach((userId, index) => {
            const iframe = document.createElement('iframe');
            iframe.id = `window_${index}`;
            iframe.src = `../../../?userid=${userId}&pwd=${pwds[index]}`;
            iframe.className = 'iframe-window';
            iframe.onload = onIframeLoaded;
            container.appendChild(iframe);
        });
    }


</script>
</html>
